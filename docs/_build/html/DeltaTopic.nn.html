<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<link rel="author" title="About these documents" href="about.html" /><link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" />

    <!-- Generated with Sphinx 6.1.3 and Furo 2023.03.27 -->
        <title>DeltaTopic.nn package - DeltaTopic documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=fad236701ea90a88636c2a8c73b44ae642ed2a53" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">DeltaTopic  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">DeltaTopic  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Main</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="api.html">API</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="DeltaTopic.nn.modelhub.BALSAM.html">DeltaTopic.nn.modelhub.BALSAM</a></li>
<li class="toctree-l2"><a class="reference internal" href="DeltaTopic.nn.modelhub.DeltaTopic.html">DeltaTopic.nn.modelhub.DeltaTopic</a></li>
<li class="toctree-l2"><a class="reference internal" href="DeltaTopic.nn.module.BALSAM_module.html">DeltaTopic.nn.module.BALSAM_module</a></li>
<li class="toctree-l2"><a class="reference internal" href="DeltaTopic.nn.module.DeltaTopic_module.html">DeltaTopic.nn.module.DeltaTopic_module</a></li>
<li class="toctree-l2"><a class="reference internal" href="DeltaTopic.nn.base_components.BALSAMEncoder.html">DeltaTopic.nn.base_components.BALSAMEncoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="DeltaTopic.nn.base_components.BALSAMDecoder.html">DeltaTopic.nn.base_components.BALSAMDecoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="DeltaTopic.nn.base_components.DeltaTopicEncoder.html">DeltaTopic.nn.base_components.DeltaTopicEncoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="DeltaTopic.nn.base_components.DeltaTopicDecoder.html">DeltaTopic.nn.base_components.DeltaTopicDecoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="DeltaTopic.nn.TrainingPlan.TrainingPlan.html">DeltaTopic.nn.TrainingPlan.TrainingPlan</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="deltatopic-nn-package">
<h1>DeltaTopic.nn package<a class="headerlink" href="#deltatopic-nn-package" title="Permalink to this heading">#</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">#</a></h2>
</section>
<section id="module-DeltaTopic.nn.TrainingPlan">
<span id="deltatopic-nn-trainingplan-module"></span><h2>DeltaTopic.nn.TrainingPlan module<a class="headerlink" href="#module-DeltaTopic.nn.TrainingPlan" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="DeltaTopic.nn.TrainingPlan.TrainingPlan">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DeltaTopic.nn.TrainingPlan.</span></span><span class="sig-name descname"><span class="pre">TrainingPlan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/TrainingPlan.html#TrainingPlan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.TrainingPlan.TrainingPlan" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">LightningModule</span></code></p>
<p>Lightning module task to train deltaTopic modules.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>module</strong> – A module instance from class <code class="docutils literal notranslate"><span class="pre">BaseModuleClass</span></code>.</p></li>
<li><p><strong>lr</strong> – Learning rate used for optimization.</p></li>
<li><p><strong>weight_decay</strong> – Weight decay used in optimizatoin.</p></li>
<li><p><strong>eps</strong> – eps used for optimization.</p></li>
<li><p><strong>optimizer</strong> – One of “Adam” (<code class="xref py py-class docutils literal notranslate"><span class="pre">Adam</span></code>), “AdamW” (<code class="xref py py-class docutils literal notranslate"><span class="pre">AdamW</span></code>).</p></li>
<li><p><strong>n_steps_kl_warmup</strong> – Number of training steps (minibatches) to scale weight on KL divergences from 0 to 1.
Only activated when <cite>n_epochs_kl_warmup</cite> is set to None.</p></li>
<li><p><strong>n_epochs_kl_warmup</strong> – Number of epochs to scale weight on KL divergences from 0 to 1.
Overrides <cite>n_steps_kl_warmup</cite> when both are not <cite>None</cite>.</p></li>
<li><p><strong>reduce_lr_on_plateau</strong> – Whether to monitor validation loss and reduce learning rate when validation set
<cite>lr_scheduler_metric</cite> plateaus.</p></li>
<li><p><strong>lr_factor</strong> – Factor to reduce learning rate.</p></li>
<li><p><strong>lr_patience</strong> – Number of epochs with no improvement after which learning rate will be reduced.</p></li>
<li><p><strong>lr_threshold</strong> – Threshold for measuring the new optimum.</p></li>
<li><p><strong>lr_scheduler_metric</strong> – Which metric to track for learning rate reduction.</p></li>
<li><p><strong>lr_min</strong> – Minimum learning rate allowed</p></li>
<li><p><strong>**loss_kwargs</strong> – Keyword args to pass to the loss method of the <cite>module</cite>.
<cite>kl_weight</cite> should not be passed here and is handled automatically.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.TrainingPlan.TrainingPlan.configure_optimizers">
<span class="sig-name descname"><span class="pre">configure_optimizers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/TrainingPlan.html#TrainingPlan.configure_optimizers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.TrainingPlan.TrainingPlan.configure_optimizers" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.TrainingPlan.TrainingPlan.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/TrainingPlan.html#TrainingPlan.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.TrainingPlan.TrainingPlan.forward" title="Permalink to this definition">#</a></dt>
<dd><p>Passthrough to <cite>model.forward()</cite>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="DeltaTopic.nn.TrainingPlan.TrainingPlan.kl_weight">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">kl_weight</span></span><a class="headerlink" href="#DeltaTopic.nn.TrainingPlan.TrainingPlan.kl_weight" title="Permalink to this definition">#</a></dt>
<dd><p>Scaling factor on KL divergence during training.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="DeltaTopic.nn.TrainingPlan.TrainingPlan.n_obs_training">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_obs_training</span></span><a class="headerlink" href="#DeltaTopic.nn.TrainingPlan.TrainingPlan.n_obs_training" title="Permalink to this definition">#</a></dt>
<dd><p>Number of observations in the training set.</p>
<p>This will update the loss kwargs for loss rescaling.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.TrainingPlan.TrainingPlan.training_epoch_end">
<span class="sig-name descname"><span class="pre">training_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/TrainingPlan.html#TrainingPlan.training_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.TrainingPlan.TrainingPlan.training_epoch_end" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.TrainingPlan.TrainingPlan.training_step">
<span class="sig-name descname"><span class="pre">training_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/TrainingPlan.html#TrainingPlan.training_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.TrainingPlan.TrainingPlan.training_step" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.TrainingPlan.TrainingPlan.validation_epoch_end">
<span class="sig-name descname"><span class="pre">validation_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/TrainingPlan.html#TrainingPlan.validation_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.TrainingPlan.TrainingPlan.validation_epoch_end" title="Permalink to this definition">#</a></dt>
<dd><p>Aggregate validation step information.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.TrainingPlan.TrainingPlan.validation_step">
<span class="sig-name descname"><span class="pre">validation_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/TrainingPlan.html#TrainingPlan.validation_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.TrainingPlan.TrainingPlan.validation_step" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-DeltaTopic.nn.base_components">
<span id="deltatopic-nn-base-components-module"></span><h2>DeltaTopic.nn.base_components module<a class="headerlink" href="#module-DeltaTopic.nn.base_components" title="Permalink to this heading">#</a></h2>
<p>base components for VAE, ETM, pathway-guided connection</p>
<dl class="py class">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_components.BALSAMDecoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DeltaTopic.nn.base_components.</span></span><span class="sig-name descname"><span class="pre">BALSAMDecoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/base_components.html#BALSAMDecoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.base_components.BALSAMDecoder" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Decoder for BALSAM model</p>
<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_components.BALSAMDecoder.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/base_components.html#BALSAMDecoder.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.base_components.BALSAMDecoder.forward" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_components.BALSAMDecoder.get_beta">
<span class="sig-name descname"><span class="pre">get_beta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spike_logit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slab_mean</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slab_lnvar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias_d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/base_components.html#BALSAMDecoder.get_beta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.base_components.BALSAMDecoder.get_beta" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_components.BALSAMDecoder.get_rho">
<span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/base_components.html#BALSAMDecoder.get_rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.base_components.BALSAMDecoder.get_rho" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_components.BALSAMDecoder.soft_max">
<span class="sig-name descname"><span class="pre">soft_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/base_components.html#BALSAMDecoder.soft_max"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.base_components.BALSAMDecoder.soft_max" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_components.BALSAMDecoder.sparse_kl_loss">
<span class="sig-name descname"><span class="pre">sparse_kl_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logit_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lnvar_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spike_logit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slab_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slab_lnvar</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/base_components.html#BALSAMDecoder.sparse_kl_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.base_components.BALSAMDecoder.sparse_kl_loss" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_components.BALSAMEncoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DeltaTopic.nn.base_components.</span></span><span class="sig-name descname"><span class="pre">BALSAMEncoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/base_components.html#BALSAMEncoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.base_components.BALSAMEncoder" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Encoder for BALSAM model</p>
<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_components.BALSAMEncoder.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">cat_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/base_components.html#BALSAMEncoder.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.base_components.BALSAMEncoder.forward" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_components.DeltaTopicDecoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DeltaTopic.nn.base_components.</span></span><span class="sig-name descname"><span class="pre">DeltaTopicDecoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/base_components.html#DeltaTopicDecoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.base_components.DeltaTopicDecoder" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Decoder for DeltaTopic model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_components.DeltaTopicDecoder.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/base_components.html#DeltaTopicDecoder.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.base_components.DeltaTopicDecoder.forward" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_components.DeltaTopicDecoder.get_beta">
<span class="sig-name descname"><span class="pre">get_beta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spike_logit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slab_mean</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slab_lnvar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias_gene</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/base_components.html#DeltaTopicDecoder.get_beta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.base_components.DeltaTopicDecoder.get_beta" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_components.DeltaTopicDecoder.get_rho_delta">
<span class="sig-name descname"><span class="pre">get_rho_delta</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/base_components.html#DeltaTopicDecoder.get_rho_delta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.base_components.DeltaTopicDecoder.get_rho_delta" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_components.DeltaTopicDecoder.soft_max">
<span class="sig-name descname"><span class="pre">soft_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/base_components.html#DeltaTopicDecoder.soft_max"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.base_components.DeltaTopicDecoder.soft_max" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_components.DeltaTopicDecoder.sparse_kl_loss">
<span class="sig-name descname"><span class="pre">sparse_kl_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logit_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lnvar_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spike_logit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slab_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slab_lnvar</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/base_components.html#DeltaTopicDecoder.sparse_kl_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.base_components.DeltaTopicDecoder.sparse_kl_loss" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_components.DeltaTopicEncoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DeltaTopic.nn.base_components.</span></span><span class="sig-name descname"><span class="pre">DeltaTopicEncoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/base_components.html#DeltaTopicEncoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.base_components.DeltaTopicEncoder" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Encoder for DeltaTopic model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_components.DeltaTopicEncoder.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">cat_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/base_components.html#DeltaTopicEncoder.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.base_components.DeltaTopicEncoder.forward" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_components.FCLayers">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DeltaTopic.nn.base_components.</span></span><span class="sig-name descname"><span class="pre">FCLayers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/base_components.html#FCLayers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.base_components.FCLayers" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>A helper class to build fully-connected layers for a neural network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_in</strong> – The dimensionality of the input</p></li>
<li><p><strong>n_out</strong> – The dimensionality of the output</p></li>
<li><p><strong>n_cat_list</strong> – A list containing, for each category of interest,
the number of categories. Each category will be
included using a one-hot encoding.</p></li>
<li><p><strong>n_layers</strong> – The number of fully-connected hidden layers</p></li>
<li><p><strong>n_hidden</strong> – The number of nodes per hidden layer</p></li>
<li><p><strong>dropout_rate</strong> – Dropout rate to apply to each of the hidden layers</p></li>
<li><p><strong>use_batch_norm</strong> – Whether to have <cite>BatchNorm</cite> layers or not</p></li>
<li><p><strong>use_layer_norm</strong> – Whether to have <cite>LayerNorm</cite> layers or not</p></li>
<li><p><strong>use_activation</strong> – Whether to have layer activation or not</p></li>
<li><p><strong>bias</strong> – Whether to learn bias in linear layers or not</p></li>
<li><p><strong>inject_covariates</strong> – Whether to inject covariates in each layer, or just the first (default).</p></li>
<li><p><strong>activation_fn</strong> – Which activation function to use</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_components.FCLayers.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">cat_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/base_components.html#FCLayers.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.base_components.FCLayers.forward" title="Permalink to this definition">#</a></dt>
<dd><p>Forward computation on <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em>) – tensor of values with shape <code class="docutils literal notranslate"><span class="pre">(n_in,)</span></code></p></li>
<li><p><strong>cat_list</strong> – list of category membership(s) for this sample</p></li>
<li><p><strong>x</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>tensor of shape <code class="docutils literal notranslate"><span class="pre">(n_out,)</span></code></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>py:class:<cite>torch.Tensor</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_components.FCLayers.inject_into_layer">
<span class="sig-name descname"><span class="pre">inject_into_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_num</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/DeltaTopic/nn/base_components.html#FCLayers.inject_into_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.base_components.FCLayers.inject_into_layer" title="Permalink to this definition">#</a></dt>
<dd><p>Helper to determine if covariates should be injected.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_components.FCLayers.set_online_update_hooks">
<span class="sig-name descname"><span class="pre">set_online_update_hooks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hook_first_layer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/base_components.html#FCLayers.set_online_update_hooks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.base_components.FCLayers.set_online_update_hooks" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_components.MaskedLinear">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DeltaTopic.nn.base_components.</span></span><span class="sig-name descname"><span class="pre">MaskedLinear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/base_components.html#MaskedLinear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.base_components.MaskedLinear" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Linear</span></code></p>
<p>same as Linear except has a configurable mask on the weights</p>
<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_components.MaskedLinear.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/base_components.html#MaskedLinear.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.base_components.MaskedLinear.forward" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_components.MaskedLinearLayers">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DeltaTopic.nn.base_components.</span></span><span class="sig-name descname"><span class="pre">MaskedLinearLayers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/base_components.html#MaskedLinearLayers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.base_components.MaskedLinearLayers" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#DeltaTopic.nn.base_components.FCLayers" title="DeltaTopic.nn.base_components.FCLayers"><code class="xref py py-class docutils literal notranslate"><span class="pre">FCLayers</span></code></a></p>
<p>This incorporates the one-hot encoding for for category input.
A helper class to build Masked Linear layers compatible with FClayer
:param n_in: The dimensionality of the input
:param n_out: The dimensionality of the output
:param mask: The mask, should be dimension n_out * n_in
:param mask_first: wheather mask linear layer should be before or after fully-connected layers, default is true;</p>
<blockquote>
<div><p>False is useful to construct an decoder with the oposite strucutre (mask linear after fully connected)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_cat_list</strong> – A list containing, for each category of interest,
the number of categories. Each category will be
included using a one-hot encoding.</p></li>
<li><p><strong>n_layers</strong> – The number of fully-connected hidden layers</p></li>
<li><p><strong>n_hidden</strong> – The number of nodes per hidden layer</p></li>
<li><p><strong>dropout_rate</strong> – Dropout rate to apply to each of the hidden layers</p></li>
<li><p><strong>use_batch_norm</strong> – Whether to have <cite>BatchNorm</cite> layers or not</p></li>
<li><p><strong>use_layer_norm</strong> – Whether to have <cite>LayerNorm</cite> layers or not</p></li>
<li><p><strong>use_activation</strong> – Whether to have layer activation or not</p></li>
<li><p><strong>bias</strong> – Whether to learn bias in linear layers or not</p></li>
<li><p><strong>inject_covariates</strong> – Whether to inject covariates in each layer, or just the first (default).</p></li>
<li><p><strong>activation_fn</strong> – Which activation function to use</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_components.MaskedLinearLayers.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">cat_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/base_components.html#MaskedLinearLayers.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.base_components.MaskedLinearLayers.forward" title="Permalink to this definition">#</a></dt>
<dd><p>Forward computation on <code class="docutils literal notranslate"><span class="pre">x</span></code>.
:param x: tensor of values with shape <code class="docutils literal notranslate"><span class="pre">(n_in,)</span></code>
:param cat_list: list of category membership(s) for this sample
:param x:
:type x: torch.Tensor</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>tensor of shape <code class="docutils literal notranslate"><span class="pre">(n_out,)</span></code></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>py:class:<cite>torch.Tensor</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_components.identity">
<span class="sig-prename descclassname"><span class="pre">DeltaTopic.nn.base_components.</span></span><span class="sig-name descname"><span class="pre">identity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/base_components.html#identity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.base_components.identity" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_components.one_hot">
<span class="sig-prename descclassname"><span class="pre">DeltaTopic.nn.base_components.</span></span><span class="sig-name descname"><span class="pre">one_hot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/DeltaTopic/nn/base_components.html#one_hot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.base_components.one_hot" title="Permalink to this definition">#</a></dt>
<dd><p>One hot a tensor of categories.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_components.reparameterize_gaussian">
<span class="sig-prename descclassname"><span class="pre">DeltaTopic.nn.base_components.</span></span><span class="sig-name descname"><span class="pre">reparameterize_gaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/base_components.html#reparameterize_gaussian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.base_components.reparameterize_gaussian" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="module-DeltaTopic.nn.base_model">
<span id="deltatopic-nn-base-model-module"></span><h2>DeltaTopic.nn.base_model module<a class="headerlink" href="#module-DeltaTopic.nn.base_model" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_model.BaseModuleClass">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DeltaTopic.nn.base_model.</span></span><span class="sig-name descname"><span class="pre">BaseModuleClass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/base_model.html#BaseModuleClass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.base_model.BaseModuleClass" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Abstract class for deltaTopic modules.</p>
<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_model.BaseModuleClass.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_inference_input_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_generative_input_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inference_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generative_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#DeltaTopic.nn.base_model.LossRecorder" title="DeltaTopic.nn.base_model.LossRecorder"><span class="pre">LossRecorder</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/DeltaTopic/nn/base_model.html#BaseModuleClass.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.base_model.BaseModuleClass.forward" title="Permalink to this definition">#</a></dt>
<dd><p>Forward pass through the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensors</strong> – tensors to pass through</p></li>
<li><p><strong>get_inference_input_kwargs</strong> – Keyword args for <cite>_get_inference_input()</cite></p></li>
<li><p><strong>get_generative_input_kwargs</strong> – Keyword args for <cite>_get_generative_input()</cite></p></li>
<li><p><strong>inference_kwargs</strong> – Keyword args for <cite>inference()</cite></p></li>
<li><p><strong>generative_kwargs</strong> – Keyword args for <cite>generative()</cite></p></li>
<li><p><strong>loss_kwargs</strong> – Keyword args for <cite>loss()</cite></p></li>
<li><p><strong>compute_loss</strong> – Whether to compute loss on forward pass. This adds
another return value.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_model.BaseModuleClass.generative">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">generative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/DeltaTopic/nn/base_model.html#BaseModuleClass.generative"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.base_model.BaseModuleClass.generative" title="Permalink to this definition">#</a></dt>
<dd><p>Run the generative model.</p>
<p>This function should return the parameters associated with the likelihood of the data.
This is typically written as <span class="math notranslate nohighlight">\(p(x|z)\)</span>.</p>
<p>This function should return a dictionary with str keys and <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code> values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_model.BaseModuleClass.inference">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/DeltaTopic/nn/base_model.html#BaseModuleClass.inference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.base_model.BaseModuleClass.inference" title="Permalink to this definition">#</a></dt>
<dd><p>Run the inference (recognition) model.</p>
<p>In the case of variational inference, this function will perform steps related to
computing variational distribution parameters. In a VAE, this will involve running
data through encoder networks.</p>
<p>This function should return a dictionary with str keys and <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code> values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_model.BaseModuleClass.loss">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#DeltaTopic.nn.base_model.LossRecorder" title="DeltaTopic.nn.base_model.LossRecorder"><span class="pre">LossRecorder</span></a></span></span><a class="reference internal" href="_modules/DeltaTopic/nn/base_model.html#BaseModuleClass.loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.base_model.BaseModuleClass.loss" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the loss for a minibatch of data.</p>
<p>This function uses the outputs of the inference and generative functions to compute
a loss. This many optionally include other penalty terms, which should be computed here.</p>
<p>This function should return an object of type <code class="xref py py-class docutils literal notranslate"><span class="pre">LossRecorder</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_model.BaseModuleClass.sample">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/base_model.html#BaseModuleClass.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.base_model.BaseModuleClass.sample" title="Permalink to this definition">#</a></dt>
<dd><p>Generate samples from the learned model.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_model.LossRecorder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DeltaTopic.nn.base_model.</span></span><span class="sig-name descname"><span class="pre">LossRecorder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reconstruction_loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kl_local</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kl_global</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/base_model.html#LossRecorder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.base_model.LossRecorder" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Loss signature for models.</p>
<p>This class provides an organized way to record the model loss, as well as
the components of the ELBO. This may also be used in MLE, MAP, EM methods.
The loss is used for backpropagation during inference. The other parameters
are used for logging/early stopping during inference.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss</strong> – Tensor with loss for minibatch. Should be one dimensional with one value.
Note that loss should be a <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code> and not the result of <cite>.item()</cite>.</p></li>
<li><p><strong>reconstruction_loss</strong> – Reconstruction loss for each observation in the minibatch.</p></li>
<li><p><strong>kl_local</strong> – KL divergence associated with each observation in the minibatch.</p></li>
<li><p><strong>kl_global</strong> – Global kl divergence term. Should be one dimensional with one value.</p></li>
<li><p><strong>**kwargs</strong> – Additional metrics can be passed as keyword arguments and will
be available as attributes of the object.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_model.LossRecorder.kl_global">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">kl_global</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></em><a class="headerlink" href="#DeltaTopic.nn.base_model.LossRecorder.kl_global" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_model.LossRecorder.kl_local">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">kl_local</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></em><a class="headerlink" href="#DeltaTopic.nn.base_model.LossRecorder.kl_local" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_model.LossRecorder.loss">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">loss</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></em><a class="headerlink" href="#DeltaTopic.nn.base_model.LossRecorder.loss" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_model.LossRecorder.reconstruction_loss">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reconstruction_loss</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></em><a class="headerlink" href="#DeltaTopic.nn.base_model.LossRecorder.reconstruction_loss" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DeltaTopic.nn.base_model.auto_move_data">
<span class="sig-prename descclassname"><span class="pre">DeltaTopic.nn.base_model.</span></span><span class="sig-name descname"><span class="pre">auto_move_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span></span></span><a class="reference internal" href="_modules/DeltaTopic/nn/base_model.html#auto_move_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.base_model.auto_move_data" title="Permalink to this definition">#</a></dt>
<dd><p>Decorator for <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> methods to move data to correct device.</p>
<p>Input arguments are moved automatically to the correct device.
It has no effect if applied to a method of an object that is not an instance of
<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> and is typically applied to <code class="docutils literal notranslate"><span class="pre">__call__</span></code>
or <code class="docutils literal notranslate"><span class="pre">forward</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fn</strong> – A nn.Module method for which the arguments should be moved to the device
the parameters are on.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-DeltaTopic.nn.dataloader_util">
<span id="deltatopic-nn-dataloader-util-module"></span><h2>DeltaTopic.nn.dataloader_util module<a class="headerlink" href="#module-DeltaTopic.nn.dataloader_util" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="DeltaTopic.nn.dataloader_util.AnnDataLoader">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DeltaTopic.nn.dataloader_util.</span></span><span class="sig-name descname"><span class="pre">AnnDataLoader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/dataloader_util.html#AnnDataLoader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.dataloader_util.AnnDataLoader" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">DataLoader</span></code></p>
<p>DataLoader for loading tensors from AnnData objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> – An anndata objects</p></li>
<li><p><strong>shuffle</strong> – Whether the data should be shuffled</p></li>
<li><p><strong>indices</strong> – The indices of the observations in the adata to load</p></li>
<li><p><strong>batch_size</strong> – minibatch size to load each iteration</p></li>
<li><p><strong>data_and_attributes</strong> – Dictionary with keys representing keys in data registry (<cite>adata.uns[“deltaTopic”]</cite>)
and value equal to desired numpy loading type (later made into torch tensor).
If <cite>None</cite>, defaults to all registered data.</p></li>
<li><p><strong>data_loader_kwargs</strong> – Keyword arguments for <code class="xref py py-class docutils literal notranslate"><span class="pre">DataLoader</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="DeltaTopic.nn.dataloader_util.AnnTorchDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DeltaTopic.nn.dataloader_util.</span></span><span class="sig-name descname"><span class="pre">AnnTorchDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/dataloader_util.html#AnnTorchDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.dataloader_util.AnnTorchDataset" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></p>
<p>Extension of torch dataset to get tensors from anndata.</p>
<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.dataloader_util.AnnTorchDataset.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scvi_data_key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/dataloader_util.html#AnnTorchDataset.get_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.dataloader_util.AnnTorchDataset.get_data" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="DeltaTopic.nn.dataloader_util.AnnTorchDataset.registered_keys">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">registered_keys</span></span><a class="headerlink" href="#DeltaTopic.nn.dataloader_util.AnnTorchDataset.registered_keys" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the keys of the mappings in deltaTopic data registry.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.dataloader_util.AnnTorchDataset.setup_data_attr">
<span class="sig-name descname"><span class="pre">setup_data_attr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/dataloader_util.html#AnnTorchDataset.setup_data_attr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.dataloader_util.AnnTorchDataset.setup_data_attr" title="Permalink to this definition">#</a></dt>
<dd><p>Sets data attribute.</p>
<p>Reduces number of times anndata needs to be accessed</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.dataloader_util.AnnTorchDataset.setup_getitem">
<span class="sig-name descname"><span class="pre">setup_getitem</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/dataloader_util.html#AnnTorchDataset.setup_getitem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.dataloader_util.AnnTorchDataset.setup_getitem" title="Permalink to this definition">#</a></dt>
<dd><p>Sets up the __getitem__ function used by Pytorch.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="DeltaTopic.nn.dataloader_util.BatchSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DeltaTopic.nn.dataloader_util.</span></span><span class="sig-name descname"><span class="pre">BatchSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/dataloader_util.html#BatchSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.dataloader_util.BatchSampler" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Sampler</span></code></p>
<p>Custom torch Sampler that returns a list of indices of size batch_size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indices</strong> – list of indices to sample from</p></li>
<li><p><strong>batch_size</strong> – batch size of each iteration</p></li>
<li><p><strong>shuffle</strong> – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, shuffles indices before sampling</p></li>
<li><p><strong>drop_last</strong> – if int, drops the last batch if its length is less than drop_last.
if drop_last == True, drops last non-full batch.
if drop_last == False, iterate over all batches.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DeltaTopic.nn.dataloader_util.get_from_registry">
<span class="sig-prename descclassname"><span class="pre">DeltaTopic.nn.dataloader_util.</span></span><span class="sig-name descname"><span class="pre">get_from_registry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">anndata.AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="reference internal" href="_modules/DeltaTopic/nn/dataloader_util.html#get_from_registry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.dataloader_util.get_from_registry" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the object in AnnData associated with the key in <code class="docutils literal notranslate"><span class="pre">.uns['deltaTopic']['data_registry']</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> – anndata object already setup with <cite>setup_anndata()</cite></p></li>
<li><p><strong>key</strong> – key of object to get from <code class="docutils literal notranslate"><span class="pre">adata.uns['deltaTopic]['data_registry']</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>The requested data</p>
</dd>
</dl>
<p class="rubric">Examples</p>
</dd></dl>

</section>
<section id="module-DeltaTopic.nn.modelhub">
<span id="deltatopic-nn-modelhub-module"></span><h2>DeltaTopic.nn.modelhub module<a class="headerlink" href="#module-DeltaTopic.nn.modelhub" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="DeltaTopic.nn.modelhub.BALSAM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DeltaTopic.nn.modelhub.</span></span><span class="sig-name descname"><span class="pre">BALSAM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_seq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">anndata.AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_latent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">model_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/modelhub.html#BALSAM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.modelhub.BALSAM" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#DeltaTopic.nn.util.BaseModelClass" title="DeltaTopic.nn.util.BaseModelClass"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModelClass</span></code></a></p>
<p>Bayesian Latent topic analysis with Sparse Association Matrix (BALSAM).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> – AnnData object that has been registered via <a class="reference internal" href="#DeltaTopic.nn.util.setup_anndata" title="DeltaTopic.nn.util.setup_anndata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setup_anndata()</span></code></a>.</p></li>
<li><p><strong>n_latent</strong> – Dimensionality of the latent space</p></li>
<li><p><strong>**model_kwargs</strong> – Keyword args for <a class="reference internal" href="DeltaTopic.nn.module.BALSAM_module.html#DeltaTopic.nn.module.BALSAM_module" title="DeltaTopic.nn.module.BALSAM_module"><code class="xref py py-class docutils literal notranslate"><span class="pre">BALSAM_module</span></code></a></p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">adata</span> <span class="o">=</span> <span class="n">anndata</span><span class="o">.</span><span class="n">read_h5ad</span><span class="p">(</span><span class="n">path_to_anndata</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DeltaTopic</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">setup_anndata</span><span class="p">(</span><span class="n">adata</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">DeltaTopic</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">modelhub</span><span class="o">.</span><span class="n">BALSAM</span><span class="p">(</span><span class="n">adata</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.modelhub.BALSAM.get_latent_representation">
<span class="sig-name descname"><span class="pre">get_latent_representation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">anndata.AnnData</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_softmax_z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DeltaTopic.nn.modelhub.BALSAM.get_latent_representation" title="Permalink to this definition">#</a></dt>
<dd><p>Return the latent space (topic proportions) for each dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adatas</strong> – List of adata_spliced and adata_unspliced.</p></li>
<li><p><strong>deterministic</strong> – If true, use the mean of the encoder instead of a Gaussian sample.</p></li>
<li><p><strong>output_softmax_z</strong> – if true, output probability, otherwise output z.</p></li>
<li><p><strong>batch_size</strong> – Minibatch size for data loading into model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.modelhub.BALSAM.get_parameters">
<span class="sig-name descname"><span class="pre">get_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DeltaTopic.nn.modelhub.BALSAM.get_parameters" title="Permalink to this definition">#</a></dt>
<dd><p>Return the spike and slab parameters of the model to the save_dir.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>save_dir</strong> – Save directory.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.modelhub.BALSAM.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_anndata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">anndata_write_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/modelhub.html#BALSAM.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.modelhub.BALSAM.save" title="Permalink to this definition">#</a></dt>
<dd><p>Save the state of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir_path</strong> – Path to a directory.</p></li>
<li><p><strong>overwrite</strong> – Overwrite existing data or not. If <cite>False</cite> and directory
already exists at <cite>dir_path</cite>, error will be raised.</p></li>
<li><p><strong>save_anndata</strong> – If True, also saves the anndata</p></li>
<li><p><strong>anndata_write_kwargs</strong> – Kwargs for anndata write function</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.modelhub.BALSAM.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_gpu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_steps_kl_warmup</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_epochs_kl_warmup</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plan_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/modelhub.html#BALSAM.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.modelhub.BALSAM.train" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the model using amortized variational inference.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_epochs</strong> – Number of passes through the dataset.</p></li>
<li><p><strong>lr</strong> – Learning rate for optimization.</p></li>
<li><p><strong>use_gpu</strong> – Use default GPU if available (if None or True), or index of GPU to use (if int),
or name of GPU (if str, e.g., <cite>‘cuda:0’</cite>), or use CPU (if False).</p></li>
<li><p><strong>train_size</strong> – Size of training set in the range [0.0, 1.0].</p></li>
<li><p><strong>validation_size</strong> – Size of the test set. If <cite>None</cite>, defaults to 1 - <cite>train_size</cite>. If
<cite>train_size + validation_size &lt; 1</cite>, the remaining cells belong to a test set.</p></li>
<li><p><strong>batch_size</strong> – Minibatch size to use during training.</p></li>
<li><p><strong>n_steps_kl_warmup</strong> – Number of training steps (minibatches) to scale weight on KL divergences from 0 to 1.
Only activated when <cite>n_epochs_kl_warmup</cite> is set to None. If <cite>None</cite>, defaults
to <cite>floor(0.75 * adata.n_obs)</cite>.</p></li>
<li><p><strong>n_epochs_kl_warmup</strong> – Number of epochs to scale weight on KL divergences from 0 to 1.
Overrides <cite>n_steps_kl_warmup</cite> when both are not <cite>None</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="DeltaTopic.nn.modelhub.DeltaTopic">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DeltaTopic.nn.modelhub.</span></span><span class="sig-name descname"><span class="pre">DeltaTopic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_seq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">anndata.AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_latent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">model_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/modelhub.html#DeltaTopic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.modelhub.DeltaTopic" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#DeltaTopic.nn.util.BaseModelClass" title="DeltaTopic.nn.util.BaseModelClass"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModelClass</span></code></a></p>
<p>Dynamically-Encoded Latent Transcriptomic pattern Analysis by Topic modelling (DeltaTopic).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> – AnnData object that has been registered via <a class="reference internal" href="#DeltaTopic.nn.util.setup_anndata" title="DeltaTopic.nn.util.setup_anndata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setup_anndata()</span></code></a>.</p></li>
<li><p><strong>n_latent</strong> – Dimensionality of the latent space</p></li>
<li><p><strong>**model_kwargs</strong> – Keyword args for <a class="reference internal" href="DeltaTopic.nn.module.DeltaTopic_module.html#DeltaTopic.nn.module.DeltaTopic_module" title="DeltaTopic.nn.module.DeltaTopic_module"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeltaTopic_module</span></code></a></p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">adata</span><span class="o">=</span> <span class="n">anndata</span><span class="o">.</span><span class="n">read_h5ad</span><span class="p">(</span><span class="n">path_to_anndata_spliced</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_unspliced</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">path_to_anndata_spliced</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adata</span><span class="o">.</span><span class="n">obsm</span><span class="p">[</span><span class="s2">&quot;unspliced_expression&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">csr_matrix</span><span class="p">(</span><span class="n">X_unspliced</span><span class="o">.</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DeltaTopic</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">setup_anndata</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="s2">&quot;counts&quot;</span><span class="p">,</span> <span class="n">unspliced_obsm_key</span> <span class="o">=</span> <span class="s2">&quot;unspliced_expression&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">DeltaTopic</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">modelhub</span><span class="o">.</span><span class="n">DeltaTopic</span><span class="p">(</span><span class="n">adata</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.modelhub.DeltaTopic.get_latent_representation">
<span class="sig-name descname"><span class="pre">get_latent_representation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">anndata.AnnData</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_softmax_z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DeltaTopic.nn.modelhub.DeltaTopic.get_latent_representation" title="Permalink to this definition">#</a></dt>
<dd><p>Return the latent space (topic proportions) for spliced and unspliced.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adatas</strong> – List of adata_spliced and adata_unspliced.</p></li>
<li><p><strong>deterministic</strong> – If true, use the mean of the encoder instead of a Gaussian sample.</p></li>
<li><p><strong>output_softmax_z</strong> – if true, output probability, otherwise output z.</p></li>
<li><p><strong>batch_size</strong> – Minibatch size for data loading into model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.modelhub.DeltaTopic.get_parameters">
<span class="sig-name descname"><span class="pre">get_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DeltaTopic.nn.modelhub.DeltaTopic.get_parameters" title="Permalink to this definition">#</a></dt>
<dd><p>return the spike logit, slab mean, slab lnvar for rho and delta.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.modelhub.DeltaTopic.get_reconstruction_error">
<span class="sig-name descname"><span class="pre">get_reconstruction_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">anndata.AnnData</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DeltaTopic.nn.modelhub.DeltaTopic.get_reconstruction_error" title="Permalink to this definition">#</a></dt>
<dd><p>Return the reconstruction error for the data.</p>
<p>Note, this is not the negative likelihood, higher is better.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> – AnnData object with equivalent structure to initial AnnData. If <cite>None</cite>, defaults to the
AnnData object used to initialize the model.</p></li>
<li><p><strong>batch_size</strong> – Minibatch size for data loading into model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.modelhub.DeltaTopic.load">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adata_seq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">anndata.AnnData</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_gpu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/modelhub.html#DeltaTopic.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.modelhub.DeltaTopic.load" title="Permalink to this definition">#</a></dt>
<dd><p>Instantiate a model from the saved output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata_seq</strong> – AnnData organized in the same way as data used to train model.</p></li>
<li><p><strong>dir_path</strong> – Path to saved outputs.</p></li>
<li><p><strong>use_gpu</strong> – Load model on default GPU if available (if None or True),
or index of GPU to use (if int), or name of GPU (if str), or use CPU (if False).</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Model with loaded state dictionaries.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.modelhub.DeltaTopic.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_anndata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">anndata_write_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/modelhub.html#DeltaTopic.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.modelhub.DeltaTopic.save" title="Permalink to this definition">#</a></dt>
<dd><p>Save the state of the model.</p>
<p>Neither the trainer optimizer state nor the trainer history are saved.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir_path</strong> – Path to a directory.</p></li>
<li><p><strong>overwrite</strong> – Overwrite existing data or not. If <cite>False</cite> and directory
already exists at <cite>dir_path</cite>, error will be raised.</p></li>
<li><p><strong>save_anndata</strong> – If True, also saves the anndata</p></li>
<li><p><strong>anndata_write_kwargs</strong> – Kwargs for anndata write function</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.modelhub.DeltaTopic.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_gpu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_steps_kl_warmup</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_epochs_kl_warmup</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plan_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/modelhub.html#DeltaTopic.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.modelhub.DeltaTopic.train" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the model using amortized variational inference.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_epochs</strong> – Number of passes through the dataset.</p></li>
<li><p><strong>lr</strong> – Learning rate for optimization.</p></li>
<li><p><strong>use_gpu</strong> – Use default GPU if available (if None or True), or index of GPU to use (if int),
or name of GPU (if str, e.g., <cite>‘cuda:0’</cite>), or use CPU (if False).</p></li>
<li><p><strong>train_size</strong> – Size of training set in the range [0.0, 1.0].</p></li>
<li><p><strong>validation_size</strong> – Size of the test set. If <cite>None</cite>, defaults to 1 - <cite>train_size</cite>. If
<cite>train_size + validation_size &lt; 1</cite>, the remaining cells belong to a test set.</p></li>
<li><p><strong>batch_size</strong> – Minibatch size to use during training.</p></li>
<li><p><strong>n_steps_kl_warmup</strong> – Number of training steps (minibatches) to scale weight on KL divergences from 0 to 1.
Only activated when <cite>n_epochs_kl_warmup</cite> is set to None. If <cite>None</cite>, defaults
to <cite>floor(0.75 * adata.n_obs)</cite>.</p></li>
<li><p><strong>n_epochs_kl_warmup</strong> – Number of epochs to scale weight on KL divergences from 0 to 1.
Overrides <cite>n_steps_kl_warmup</cite> when both are not <cite>None</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-DeltaTopic.nn.module">
<span id="deltatopic-nn-module-module"></span><h2>DeltaTopic.nn.module module<a class="headerlink" href="#module-DeltaTopic.nn.module" title="Permalink to this heading">#</a></h2>
<p>Main module.</p>
<dl class="py class">
<dt class="sig sig-object py" id="DeltaTopic.nn.module.BALSAM_module">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DeltaTopic.nn.module.</span></span><span class="sig-name descname"><span class="pre">BALSAM_module</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/module.html#BALSAM_module"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.module.BALSAM_module" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#DeltaTopic.nn.base_model.BaseModuleClass" title="DeltaTopic.nn.base_model.BaseModuleClass"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModuleClass</span></code></a></p>
<p>BALASM module</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_genes</strong> – number of genes</p></li>
<li><p><strong>n_latent</strong> – dimension of latent space</p></li>
<li><p><strong>n_layers_encoder_individual</strong> – number of individual layers in the encoder</p></li>
<li><p><strong>dim_hidden_encoder</strong> – dimension of the hidden layers in the encoder</p></li>
<li><p><strong>pip0_rho</strong> – scaling factor for rho loss, default 0.1</p></li>
<li><p><strong>kl_weight_beta</strong> – scaling factor for KL, default 1.0</p></li>
<li><p><strong>log_variational</strong> – Log(data+1) prior to encoding for numerical stability. Not normalization.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.module.BALSAM_module.dir_llik">
<span class="sig-name descname"><span class="pre">dir_llik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aa</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/DeltaTopic/nn/module.html#BALSAM_module.dir_llik"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.module.BALSAM_module.dir_llik" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the Dirichlet log-likelihood.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.module.BALSAM_module.generative">
<span class="sig-name descname"><span class="pre">generative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/DeltaTopic/nn/module.html#BALSAM_module.generative"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.module.BALSAM_module.generative" title="Permalink to this definition">#</a></dt>
<dd><p>Run the generative model.</p>
<p>This function should return the parameters associated with the likelihood of the data.
This is typically written as <span class="math notranslate nohighlight">\(p(x|z)\)</span>.</p>
<p>This function should return a dictionary with str keys and <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code> values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.module.BALSAM_module.get_reconstruction_loss">
<span class="sig-name descname"><span class="pre">get_reconstruction_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/DeltaTopic/nn/module.html#BALSAM_module.get_reconstruction_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.module.BALSAM_module.get_reconstruction_loss" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the reconstruction loss for a batch of data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – tensor of values with shape <code class="docutils literal notranslate"><span class="pre">(batch_size,</span> <span class="pre">n_input)</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>tensor of means of the scaled frequencies</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>type</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.module.BALSAM_module.inference">
<span class="sig-name descname"><span class="pre">inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/DeltaTopic/nn/module.html#BALSAM_module.inference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.module.BALSAM_module.inference" title="Permalink to this definition">#</a></dt>
<dd><p>Run the inference (recognition) model.</p>
<p>In the case of variational inference, this function will perform steps related to
computing variational distribution parameters. In a VAE, this will involve running
data through encoder networks.</p>
<p>This function should return a dictionary with str keys and <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code> values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.module.BALSAM_module.loss">
<span class="sig-name descname"><span class="pre">loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inference_outputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generative_outputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kl_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/DeltaTopic/nn/module.html#BALSAM_module.loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.module.BALSAM_module.loss" title="Permalink to this definition">#</a></dt>
<dd><p>Agrregates the likelihood and KL divergences to form the loss function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.module.BALSAM_module.sample_from_posterior_z">
<span class="sig-name descname"><span class="pre">sample_from_posterior_z</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_softmax_z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/module.html#BALSAM_module.sample_from_posterior_z"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.module.BALSAM_module.sample_from_posterior_z" title="Permalink to this definition">#</a></dt>
<dd><p>Sample from the posterior z</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="DeltaTopic.nn.module.DeltaTopic_module">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DeltaTopic.nn.module.</span></span><span class="sig-name descname"><span class="pre">DeltaTopic_module</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/module.html#DeltaTopic_module"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.module.DeltaTopic_module" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#DeltaTopic.nn.base_model.BaseModuleClass" title="DeltaTopic.nn.base_model.BaseModuleClass"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModuleClass</span></code></a></p>
<p>DeltaTopic module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_genes</strong> – number of genes</p></li>
<li><p><strong>n_latent</strong> – dimension of latent space</p></li>
<li><p><strong>n_layers_encoder_individual</strong> – number of individual layers in the encoder</p></li>
<li><p><strong>dim_hidden_encoder</strong> – dimension of the hidden layers in the encoder</p></li>
<li><p><strong>pip0_rho</strong> – scaling factor for rho loss, default 0.1</p></li>
<li><p><strong>pip0_delta</strong> – scaling factor for delta loss, default 0.1</p></li>
<li><p><strong>kl_weight_beta</strong> – scaling factor for KL, default 1.0</p></li>
<li><p><strong>log_variational</strong> – Log(data+1) prior to encoding for numerical stability. Not normalization.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.module.DeltaTopic_module.dir_llik">
<span class="sig-name descname"><span class="pre">dir_llik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aa</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/DeltaTopic/nn/module.html#DeltaTopic_module.dir_llik"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.module.DeltaTopic_module.dir_llik" title="Permalink to this definition">#</a></dt>
<dd><p>Return the Dirichlet log-likelihood for a batch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.module.DeltaTopic_module.generative">
<span class="sig-name descname"><span class="pre">generative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/DeltaTopic/nn/module.html#DeltaTopic_module.generative"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.module.DeltaTopic_module.generative" title="Permalink to this definition">#</a></dt>
<dd><p>Run the generative model.</p>
<p>This function should return the parameters associated with the likelihood of the data.
This is typically written as <span class="math notranslate nohighlight">\(p(x|z)\)</span>.</p>
<p>This function should return a dictionary with str keys and <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code> values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.module.DeltaTopic_module.get_reconstruction_loss">
<span class="sig-name descname"><span class="pre">get_reconstruction_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/DeltaTopic/nn/module.html#DeltaTopic_module.get_reconstruction_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.module.DeltaTopic_module.get_reconstruction_loss" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the reconstruction loss for the given batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – tensor of values with shape <code class="docutils literal notranslate"><span class="pre">(batch_size,</span> <span class="pre">n_input)</span></code></p></li>
<li><p><strong>y</strong> – tensor of values with shape <code class="docutils literal notranslate"><span class="pre">(batch_size,</span> <span class="pre">n_input)</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.module.DeltaTopic_module.inference">
<span class="sig-name descname"><span class="pre">inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/DeltaTopic/nn/module.html#DeltaTopic_module.inference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.module.DeltaTopic_module.inference" title="Permalink to this definition">#</a></dt>
<dd><p>Run the inference (recognition) model.</p>
<p>In the case of variational inference, this function will perform steps related to
computing variational distribution parameters. In a VAE, this will involve running
data through encoder networks.</p>
<p>This function should return a dictionary with str keys and <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code> values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.module.DeltaTopic_module.loss">
<span class="sig-name descname"><span class="pre">loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inference_outputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generative_outputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kl_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kl_weight_beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/DeltaTopic/nn/module.html#DeltaTopic_module.loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.module.DeltaTopic_module.loss" title="Permalink to this definition">#</a></dt>
<dd><p>Aggregate the kl and likelihood to form the loss.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.module.DeltaTopic_module.sample_from_posterior_z">
<span class="sig-name descname"><span class="pre">sample_from_posterior_z</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_softmax_z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/module.html#DeltaTopic_module.sample_from_posterior_z"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.module.DeltaTopic_module.sample_from_posterior_z" title="Permalink to this definition">#</a></dt>
<dd><p>sample from the posterior of latent space z</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-DeltaTopic.nn.util">
<span id="deltatopic-nn-util-module"></span><h2>DeltaTopic.nn.util module<a class="headerlink" href="#module-DeltaTopic.nn.util" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="DeltaTopic.nn.util.BaseModelClass">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DeltaTopic.nn.util.</span></span><span class="sig-name descname"><span class="pre">BaseModelClass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">anndata.AnnData</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/util.html#BaseModelClass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.util.BaseModelClass" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Abstract class for deltaTopic models.</p>
<dl class="py property">
<dt class="sig sig-object py" id="DeltaTopic.nn.util.BaseModelClass.device">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><a class="headerlink" href="#DeltaTopic.nn.util.BaseModelClass.device" title="Permalink to this definition">#</a></dt>
<dd><p>Device model is on.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="DeltaTopic.nn.util.BaseModelClass.history">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">history</span></span><a class="headerlink" href="#DeltaTopic.nn.util.BaseModelClass.history" title="Permalink to this definition">#</a></dt>
<dd><p>Returns computed metrics during training.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="DeltaTopic.nn.util.BaseModelClass.is_trained">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_trained</span></span><a class="headerlink" href="#DeltaTopic.nn.util.BaseModelClass.is_trained" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.util.BaseModelClass.load">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">anndata.AnnData</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_gpu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/util.html#BaseModelClass.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.util.BaseModelClass.load" title="Permalink to this definition">#</a></dt>
<dd><p>Instantiate a model from the saved output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir_path</strong> – Path to saved outputs.</p></li>
<li><p><strong>adata</strong> – AnnData organized in the same way as data used to train model.</p></li>
<li><p><strong>use_gpu</strong> – Load model on default GPU if available (if None or True),
or index of GPU to use (if int), or name of GPU (if str), or use CPU (if False).</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Model with loaded state dictionaries.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.util.BaseModelClass.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_anndata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">anndata_write_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/util.html#BaseModelClass.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.util.BaseModelClass.save" title="Permalink to this definition">#</a></dt>
<dd><p>Save the state of the model.</p>
<p>Neither the trainer optimizer state nor the trainer history are saved.
Model files are not expected to be reproducibly saved and loaded across versions
until we reach version 1.0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir_path</strong> – Path to a directory.</p></li>
<li><p><strong>overwrite</strong> – Overwrite existing data or not. If <cite>False</cite> and directory
already exists at <cite>dir_path</cite>, error will be raised.</p></li>
<li><p><strong>save_anndata</strong> – If True, also saves the anndata</p></li>
<li><p><strong>anndata_write_kwargs</strong> – Kwargs for <code class="xref py py-meth docutils literal notranslate"><span class="pre">write()</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="DeltaTopic.nn.util.BaseModelClass.test_indices">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">test_indices</span></span><a class="headerlink" href="#DeltaTopic.nn.util.BaseModelClass.test_indices" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.util.BaseModelClass.to_device">
<span class="sig-name descname"><span class="pre">to_device</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/util.html#BaseModelClass.to_device"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.util.BaseModelClass.to_device" title="Permalink to this definition">#</a></dt>
<dd><p>Move model to device.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device</strong> – Device to move model to. Options: ‘cpu’ for CPU, integer GPU index (eg. 0),
or ‘cuda:X’ where X is the GPU index (eg. ‘cuda:0’). See torch.device for more info.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">to_device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>      <span class="c1"># moves model to CPU</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">to_device</span><span class="p">(</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">)</span>   <span class="c1"># moves model to GPU 0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">to_device</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>          <span class="c1"># also moves model to GPU 0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.util.BaseModelClass.train">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/util.html#BaseModelClass.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.util.BaseModelClass.train" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the model.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="DeltaTopic.nn.util.BaseModelClass.train_indices">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">train_indices</span></span><a class="headerlink" href="#DeltaTopic.nn.util.BaseModelClass.train_indices" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="DeltaTopic.nn.util.BaseModelClass.validation_indices">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">validation_indices</span></span><a class="headerlink" href="#DeltaTopic.nn.util.BaseModelClass.validation_indices" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="DeltaTopic.nn.util.DataSplitter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DeltaTopic.nn.util.</span></span><span class="sig-name descname"><span class="pre">DataSplitter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/util.html#DataSplitter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.util.DataSplitter" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">LightningDataModule</span></code></p>
<p>Creates data loaders <code class="docutils literal notranslate"><span class="pre">train_set</span></code>, <code class="docutils literal notranslate"><span class="pre">validation_set</span></code>, <code class="docutils literal notranslate"><span class="pre">test_set</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">train_size</span> <span class="pre">+</span> <span class="pre">validation_set</span> <span class="pre">&lt;</span> <span class="pre">1</span></code> then <code class="docutils literal notranslate"><span class="pre">test_set</span></code> is non-empty.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> – AnnData to split into train/test/val sets</p></li>
<li><p><strong>train_size</strong> – float, or None (default is 0.9)</p></li>
<li><p><strong>validation_size</strong> – float, or None (default is None)</p></li>
<li><p><strong>use_gpu</strong> – Use default GPU if available (if None or True), or index of GPU to use (if int),
or name of GPU (if str, e.g., <cite>‘cuda:0’</cite>), or use CPU (if False).</p></li>
<li><p><strong>**kwargs</strong> – Keyword args for data loader.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">splitter</span> <span class="o">=</span> <span class="n">DataSplitter</span><span class="p">(</span><span class="n">adata</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splitter</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">train_dl</span> <span class="o">=</span> <span class="n">splitter</span><span class="o">.</span><span class="n">train_dataloader</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.util.DataSplitter.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/util.html#DataSplitter.setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.util.DataSplitter.setup" title="Permalink to this definition">#</a></dt>
<dd><p>Split indices in train/test/val sets.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.util.DataSplitter.test_dataloader">
<span class="sig-name descname"><span class="pre">test_dataloader</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/util.html#DataSplitter.test_dataloader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.util.DataSplitter.test_dataloader" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.util.DataSplitter.train_dataloader">
<span class="sig-name descname"><span class="pre">train_dataloader</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/util.html#DataSplitter.train_dataloader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.util.DataSplitter.train_dataloader" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.util.DataSplitter.val_dataloader">
<span class="sig-name descname"><span class="pre">val_dataloader</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/util.html#DataSplitter.val_dataloader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.util.DataSplitter.val_dataloader" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="DeltaTopic.nn.util.SimpleLogger">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DeltaTopic.nn.util.</span></span><span class="sig-name descname"><span class="pre">SimpleLogger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/util.html#SimpleLogger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.util.SimpleLogger" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.util.SimpleLogger.experiment">
<span class="sig-name descname"><span class="pre">experiment</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/util.html#SimpleLogger.experiment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.util.SimpleLogger.experiment" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="DeltaTopic.nn.util.SimpleLogger.history">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">history</span></span><a class="headerlink" href="#DeltaTopic.nn.util.SimpleLogger.history" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.util.SimpleLogger.log_hyperparams">
<span class="sig-name descname"><span class="pre">log_hyperparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DeltaTopic.nn.util.SimpleLogger.log_hyperparams" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.util.SimpleLogger.log_metrics">
<span class="sig-name descname"><span class="pre">log_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DeltaTopic.nn.util.SimpleLogger.log_metrics" title="Permalink to this definition">#</a></dt>
<dd><p>Record metrics.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="DeltaTopic.nn.util.SimpleLogger.name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#DeltaTopic.nn.util.SimpleLogger.name" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="DeltaTopic.nn.util.SimpleLogger.version">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">version</span></span><a class="headerlink" href="#DeltaTopic.nn.util.SimpleLogger.version" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="DeltaTopic.nn.util.TrainRunner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DeltaTopic.nn.util.</span></span><span class="sig-name descname"><span class="pre">TrainRunner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#DeltaTopic.nn.util.BaseModelClass" title="DeltaTopic.nn.util.BaseModelClass"><span class="pre">BaseModelClass</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_plan</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pytorch_lightning.LightningModule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_splitter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#DeltaTopic.nn.util.DataSplitter" title="DeltaTopic.nn.util.DataSplitter"><span class="pre">DataSplitter</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_gpu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/util.html#TrainRunner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.util.TrainRunner" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>TrainRunner calls Trainer.fit() and handles pre and post training procedures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – model to train</p></li>
<li><p><strong>training_plan</strong> – initialized TrainingPlan</p></li>
<li><p><strong>data_splitter</strong> – initialized class:<cite>DataSplitter</cite></p></li>
<li><p><strong>max_epochs</strong> – max_epochs to train for</p></li>
<li><p><strong>use_gpu</strong> – Use default GPU if available (if None or True), or index of GPU to use (if int),
or name of GPU (if str, e.g., <cite>‘cuda:0’</cite>), or use CPU (if False).</p></li>
<li><p><strong>trainer_kwargs</strong> – Extra kwargs for <a class="reference internal" href="#DeltaTopic.nn.util.Trainer" title="DeltaTopic.nn.util.Trainer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trainer</span></code></a></p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Following code should be within a subclass of BaseModelClass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_splitter</span> <span class="o">=</span> <span class="n">DataSplitter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">adata</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">training_plan</span> <span class="o">=</span> <span class="n">TrainingPlan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_splitter</span><span class="o">.</span><span class="n">train_idx</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">runner</span> <span class="o">=</span> <span class="n">TrainRunner</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="bp">self</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">training_plan</span><span class="o">=</span><span class="n">trianing_plan</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">data_splitter</span><span class="o">=</span><span class="n">data_splitter</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">max_epochs</span><span class="o">=</span><span class="n">max_epochs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">runner</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="DeltaTopic.nn.util.Trainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DeltaTopic.nn.util.</span></span><span class="sig-name descname"><span class="pre">Trainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/util.html#Trainer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.util.Trainer" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Trainer</span></code></p>
<p>Lightweight wrapper of Pytorch Lightning Trainer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gpus</strong> – Number of gpus to train on (int) or which GPUs to train on (list or str) applied per node</p></li>
<li><p><strong>benchmark</strong> – If true enables cudnn.benchmark, which improves speed when inputs are fixed size</p></li>
<li><p><strong>check_val_every_n_epoch</strong> – Check val every n train epochs. By default, val is not checked, unless <cite>early_stopping</cite> is <cite>True</cite>.</p></li>
<li><p><strong>max_epochs</strong> – Stop training once this number of epochs is reached.</p></li>
<li><p><strong>num_sanity_val_steps</strong> – Sanity check runs n validation batches before starting the training routine.
Set it to -1 to run all batches in all validation dataloaders.</p></li>
<li><p><strong>weights_summary</strong> – Prints a summary of the weights when training begins.</p></li>
<li><p><strong>early_stopping</strong> – Whether to perform early stopping with respect to the validation set. This
automatically adds a <code class="xref py py-class docutils literal notranslate"><span class="pre">EarlyStopping</span></code>
instance. A custom instance can be passed by using the callbacks argument and
setting this to <cite>False</cite>.</p></li>
<li><p><strong>early_stopping_monitor</strong> – Metric logged during validation set epoch. The available metrics will depend on
the training plan class used. We list the most common options here in the typing.</p></li>
<li><p><strong>early_stopping_min_delta</strong> – Minimum change in the monitored quantity to qualify as an improvement,
i.e. an absolute change of less than min_delta, will count as no improvement.</p></li>
<li><p><strong>early_stopping_patience</strong> – Number of validation epochs with no improvement after which training will be stopped.</p></li>
<li><p><strong>early_stopping_mode</strong> – In ‘min’ mode, training will stop when the quantity monitored has stopped decreasing
and in ‘max’ mode it will stop when the quantity monitored has stopped increasing.</p></li>
<li><p><strong>progress_bar_refresh_rate</strong> – How often to refresh progress bar (in steps). Value 0 disables progress bar.</p></li>
<li><p><strong>simple_progress_bar</strong> – Use  simple progress bar (per epoch rather than per batch)</p></li>
<li><p><strong>logger</strong> – A valid pytorch lightning logger. Defaults to a simple dictionary logger.
If <cite>True</cite>, defaults to the default pytorch lightning logger.</p></li>
<li><p><strong>**kwargs</strong> – Other keyword args for <code class="xref py py-class docutils literal notranslate"><span class="pre">Trainer</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="DeltaTopic.nn.util.Trainer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/util.html#Trainer.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.util.Trainer.fit" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DeltaTopic.nn.util.parse_use_gpu_arg">
<span class="sig-prename descclassname"><span class="pre">DeltaTopic.nn.util.</span></span><span class="sig-name descname"><span class="pre">parse_use_gpu_arg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_gpu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/util.html#parse_use_gpu_arg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.util.parse_use_gpu_arg" title="Permalink to this definition">#</a></dt>
<dd><p>Parses the use_gpu arg in codebase.</p>
<p>Returned gpus are is compatible with PytorchLightning’s gpus arg.
If return_device is True, will also return the device.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>use_gpu</strong> – Use default GPU if available (if None or True), or index of GPU to use (if int),
or name of GPU (if str, e.g., <cite>‘cuda:0’</cite>), or use CPU (if False).</p></li>
<li><p><strong>return_device</strong> – If True, will return the torch.device of use_gpu.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DeltaTopic.nn.util.setup_anndata">
<span class="sig-prename descclassname"><span class="pre">DeltaTopic.nn.util.</span></span><span class="sig-name descname"><span class="pre">setup_anndata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">anndata.AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unspliced_obsm_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unspliced_names_uns_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">anndata.AnnData</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="_modules/DeltaTopic/nn/util.html#setup_anndata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.util.setup_anndata" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DeltaTopic.nn.util.validate_data_split">
<span class="sig-prename descclassname"><span class="pre">DeltaTopic.nn.util.</span></span><span class="sig-name descname"><span class="pre">validate_data_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/DeltaTopic/nn/util.html#validate_data_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#DeltaTopic.nn.util.validate_data_split" title="Permalink to this definition">#</a></dt>
<dd><p>Check data splitting parameters and return n_train and n_val.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_samples</strong> – Number of samples to split</p></li>
<li><p><strong>train_size</strong> – Size of train set. Need to be: 0 &lt; train_size &lt;= 1.</p></li>
<li><p><strong>validation_size</strong> – Size of validation set. Need to be 0 &lt;= validation_size &lt; 1</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-DeltaTopic.nn">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-DeltaTopic.nn" title="Permalink to this heading">#</a></h2>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Yichen Zhang
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">DeltaTopic.nn package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-DeltaTopic.nn.TrainingPlan">DeltaTopic.nn.TrainingPlan module</a><ul>
<li><a class="reference internal" href="#DeltaTopic.nn.TrainingPlan.TrainingPlan"><code class="docutils literal notranslate"><span class="pre">TrainingPlan</span></code></a><ul>
<li><a class="reference internal" href="#DeltaTopic.nn.TrainingPlan.TrainingPlan.configure_optimizers"><code class="docutils literal notranslate"><span class="pre">TrainingPlan.configure_optimizers()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.TrainingPlan.TrainingPlan.forward"><code class="docutils literal notranslate"><span class="pre">TrainingPlan.forward()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.TrainingPlan.TrainingPlan.kl_weight"><code class="docutils literal notranslate"><span class="pre">TrainingPlan.kl_weight</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.TrainingPlan.TrainingPlan.n_obs_training"><code class="docutils literal notranslate"><span class="pre">TrainingPlan.n_obs_training</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.TrainingPlan.TrainingPlan.training_epoch_end"><code class="docutils literal notranslate"><span class="pre">TrainingPlan.training_epoch_end()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.TrainingPlan.TrainingPlan.training_step"><code class="docutils literal notranslate"><span class="pre">TrainingPlan.training_step()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.TrainingPlan.TrainingPlan.validation_epoch_end"><code class="docutils literal notranslate"><span class="pre">TrainingPlan.validation_epoch_end()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.TrainingPlan.TrainingPlan.validation_step"><code class="docutils literal notranslate"><span class="pre">TrainingPlan.validation_step()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-DeltaTopic.nn.base_components">DeltaTopic.nn.base_components module</a><ul>
<li><a class="reference internal" href="#DeltaTopic.nn.base_components.BALSAMDecoder"><code class="docutils literal notranslate"><span class="pre">BALSAMDecoder</span></code></a><ul>
<li><a class="reference internal" href="#DeltaTopic.nn.base_components.BALSAMDecoder.forward"><code class="docutils literal notranslate"><span class="pre">BALSAMDecoder.forward()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.base_components.BALSAMDecoder.get_beta"><code class="docutils literal notranslate"><span class="pre">BALSAMDecoder.get_beta()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.base_components.BALSAMDecoder.get_rho"><code class="docutils literal notranslate"><span class="pre">BALSAMDecoder.get_rho()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.base_components.BALSAMDecoder.soft_max"><code class="docutils literal notranslate"><span class="pre">BALSAMDecoder.soft_max()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.base_components.BALSAMDecoder.sparse_kl_loss"><code class="docutils literal notranslate"><span class="pre">BALSAMDecoder.sparse_kl_loss()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#DeltaTopic.nn.base_components.BALSAMEncoder"><code class="docutils literal notranslate"><span class="pre">BALSAMEncoder</span></code></a><ul>
<li><a class="reference internal" href="#DeltaTopic.nn.base_components.BALSAMEncoder.forward"><code class="docutils literal notranslate"><span class="pre">BALSAMEncoder.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#DeltaTopic.nn.base_components.DeltaTopicDecoder"><code class="docutils literal notranslate"><span class="pre">DeltaTopicDecoder</span></code></a><ul>
<li><a class="reference internal" href="#DeltaTopic.nn.base_components.DeltaTopicDecoder.forward"><code class="docutils literal notranslate"><span class="pre">DeltaTopicDecoder.forward()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.base_components.DeltaTopicDecoder.get_beta"><code class="docutils literal notranslate"><span class="pre">DeltaTopicDecoder.get_beta()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.base_components.DeltaTopicDecoder.get_rho_delta"><code class="docutils literal notranslate"><span class="pre">DeltaTopicDecoder.get_rho_delta()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.base_components.DeltaTopicDecoder.soft_max"><code class="docutils literal notranslate"><span class="pre">DeltaTopicDecoder.soft_max()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.base_components.DeltaTopicDecoder.sparse_kl_loss"><code class="docutils literal notranslate"><span class="pre">DeltaTopicDecoder.sparse_kl_loss()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#DeltaTopic.nn.base_components.DeltaTopicEncoder"><code class="docutils literal notranslate"><span class="pre">DeltaTopicEncoder</span></code></a><ul>
<li><a class="reference internal" href="#DeltaTopic.nn.base_components.DeltaTopicEncoder.forward"><code class="docutils literal notranslate"><span class="pre">DeltaTopicEncoder.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#DeltaTopic.nn.base_components.FCLayers"><code class="docutils literal notranslate"><span class="pre">FCLayers</span></code></a><ul>
<li><a class="reference internal" href="#DeltaTopic.nn.base_components.FCLayers.forward"><code class="docutils literal notranslate"><span class="pre">FCLayers.forward()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.base_components.FCLayers.inject_into_layer"><code class="docutils literal notranslate"><span class="pre">FCLayers.inject_into_layer()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.base_components.FCLayers.set_online_update_hooks"><code class="docutils literal notranslate"><span class="pre">FCLayers.set_online_update_hooks()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#DeltaTopic.nn.base_components.MaskedLinear"><code class="docutils literal notranslate"><span class="pre">MaskedLinear</span></code></a><ul>
<li><a class="reference internal" href="#DeltaTopic.nn.base_components.MaskedLinear.forward"><code class="docutils literal notranslate"><span class="pre">MaskedLinear.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#DeltaTopic.nn.base_components.MaskedLinearLayers"><code class="docutils literal notranslate"><span class="pre">MaskedLinearLayers</span></code></a><ul>
<li><a class="reference internal" href="#DeltaTopic.nn.base_components.MaskedLinearLayers.forward"><code class="docutils literal notranslate"><span class="pre">MaskedLinearLayers.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#DeltaTopic.nn.base_components.identity"><code class="docutils literal notranslate"><span class="pre">identity()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.base_components.one_hot"><code class="docutils literal notranslate"><span class="pre">one_hot()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.base_components.reparameterize_gaussian"><code class="docutils literal notranslate"><span class="pre">reparameterize_gaussian()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-DeltaTopic.nn.base_model">DeltaTopic.nn.base_model module</a><ul>
<li><a class="reference internal" href="#DeltaTopic.nn.base_model.BaseModuleClass"><code class="docutils literal notranslate"><span class="pre">BaseModuleClass</span></code></a><ul>
<li><a class="reference internal" href="#DeltaTopic.nn.base_model.BaseModuleClass.forward"><code class="docutils literal notranslate"><span class="pre">BaseModuleClass.forward()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.base_model.BaseModuleClass.generative"><code class="docutils literal notranslate"><span class="pre">BaseModuleClass.generative()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.base_model.BaseModuleClass.inference"><code class="docutils literal notranslate"><span class="pre">BaseModuleClass.inference()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.base_model.BaseModuleClass.loss"><code class="docutils literal notranslate"><span class="pre">BaseModuleClass.loss()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.base_model.BaseModuleClass.sample"><code class="docutils literal notranslate"><span class="pre">BaseModuleClass.sample()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#DeltaTopic.nn.base_model.LossRecorder"><code class="docutils literal notranslate"><span class="pre">LossRecorder</span></code></a><ul>
<li><a class="reference internal" href="#DeltaTopic.nn.base_model.LossRecorder.kl_global"><code class="docutils literal notranslate"><span class="pre">LossRecorder.kl_global</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.base_model.LossRecorder.kl_local"><code class="docutils literal notranslate"><span class="pre">LossRecorder.kl_local</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.base_model.LossRecorder.loss"><code class="docutils literal notranslate"><span class="pre">LossRecorder.loss</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.base_model.LossRecorder.reconstruction_loss"><code class="docutils literal notranslate"><span class="pre">LossRecorder.reconstruction_loss</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#DeltaTopic.nn.base_model.auto_move_data"><code class="docutils literal notranslate"><span class="pre">auto_move_data()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-DeltaTopic.nn.dataloader_util">DeltaTopic.nn.dataloader_util module</a><ul>
<li><a class="reference internal" href="#DeltaTopic.nn.dataloader_util.AnnDataLoader"><code class="docutils literal notranslate"><span class="pre">AnnDataLoader</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.dataloader_util.AnnTorchDataset"><code class="docutils literal notranslate"><span class="pre">AnnTorchDataset</span></code></a><ul>
<li><a class="reference internal" href="#DeltaTopic.nn.dataloader_util.AnnTorchDataset.get_data"><code class="docutils literal notranslate"><span class="pre">AnnTorchDataset.get_data()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.dataloader_util.AnnTorchDataset.registered_keys"><code class="docutils literal notranslate"><span class="pre">AnnTorchDataset.registered_keys</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.dataloader_util.AnnTorchDataset.setup_data_attr"><code class="docutils literal notranslate"><span class="pre">AnnTorchDataset.setup_data_attr()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.dataloader_util.AnnTorchDataset.setup_getitem"><code class="docutils literal notranslate"><span class="pre">AnnTorchDataset.setup_getitem()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#DeltaTopic.nn.dataloader_util.BatchSampler"><code class="docutils literal notranslate"><span class="pre">BatchSampler</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.dataloader_util.get_from_registry"><code class="docutils literal notranslate"><span class="pre">get_from_registry()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-DeltaTopic.nn.modelhub">DeltaTopic.nn.modelhub module</a><ul>
<li><a class="reference internal" href="#DeltaTopic.nn.modelhub.BALSAM"><code class="docutils literal notranslate"><span class="pre">BALSAM</span></code></a><ul>
<li><a class="reference internal" href="#DeltaTopic.nn.modelhub.BALSAM.get_latent_representation"><code class="docutils literal notranslate"><span class="pre">BALSAM.get_latent_representation()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.modelhub.BALSAM.get_parameters"><code class="docutils literal notranslate"><span class="pre">BALSAM.get_parameters()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.modelhub.BALSAM.save"><code class="docutils literal notranslate"><span class="pre">BALSAM.save()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.modelhub.BALSAM.train"><code class="docutils literal notranslate"><span class="pre">BALSAM.train()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#DeltaTopic.nn.modelhub.DeltaTopic"><code class="docutils literal notranslate"><span class="pre">DeltaTopic</span></code></a><ul>
<li><a class="reference internal" href="#DeltaTopic.nn.modelhub.DeltaTopic.get_latent_representation"><code class="docutils literal notranslate"><span class="pre">DeltaTopic.get_latent_representation()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.modelhub.DeltaTopic.get_parameters"><code class="docutils literal notranslate"><span class="pre">DeltaTopic.get_parameters()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.modelhub.DeltaTopic.get_reconstruction_error"><code class="docutils literal notranslate"><span class="pre">DeltaTopic.get_reconstruction_error()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.modelhub.DeltaTopic.load"><code class="docutils literal notranslate"><span class="pre">DeltaTopic.load()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.modelhub.DeltaTopic.save"><code class="docutils literal notranslate"><span class="pre">DeltaTopic.save()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.modelhub.DeltaTopic.train"><code class="docutils literal notranslate"><span class="pre">DeltaTopic.train()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-DeltaTopic.nn.module">DeltaTopic.nn.module module</a><ul>
<li><a class="reference internal" href="#DeltaTopic.nn.module.BALSAM_module"><code class="docutils literal notranslate"><span class="pre">BALSAM_module</span></code></a><ul>
<li><a class="reference internal" href="#DeltaTopic.nn.module.BALSAM_module.dir_llik"><code class="docutils literal notranslate"><span class="pre">BALSAM_module.dir_llik()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.module.BALSAM_module.generative"><code class="docutils literal notranslate"><span class="pre">BALSAM_module.generative()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.module.BALSAM_module.get_reconstruction_loss"><code class="docutils literal notranslate"><span class="pre">BALSAM_module.get_reconstruction_loss()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.module.BALSAM_module.inference"><code class="docutils literal notranslate"><span class="pre">BALSAM_module.inference()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.module.BALSAM_module.loss"><code class="docutils literal notranslate"><span class="pre">BALSAM_module.loss()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.module.BALSAM_module.sample_from_posterior_z"><code class="docutils literal notranslate"><span class="pre">BALSAM_module.sample_from_posterior_z()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#DeltaTopic.nn.module.DeltaTopic_module"><code class="docutils literal notranslate"><span class="pre">DeltaTopic_module</span></code></a><ul>
<li><a class="reference internal" href="#DeltaTopic.nn.module.DeltaTopic_module.dir_llik"><code class="docutils literal notranslate"><span class="pre">DeltaTopic_module.dir_llik()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.module.DeltaTopic_module.generative"><code class="docutils literal notranslate"><span class="pre">DeltaTopic_module.generative()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.module.DeltaTopic_module.get_reconstruction_loss"><code class="docutils literal notranslate"><span class="pre">DeltaTopic_module.get_reconstruction_loss()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.module.DeltaTopic_module.inference"><code class="docutils literal notranslate"><span class="pre">DeltaTopic_module.inference()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.module.DeltaTopic_module.loss"><code class="docutils literal notranslate"><span class="pre">DeltaTopic_module.loss()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.module.DeltaTopic_module.sample_from_posterior_z"><code class="docutils literal notranslate"><span class="pre">DeltaTopic_module.sample_from_posterior_z()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-DeltaTopic.nn.util">DeltaTopic.nn.util module</a><ul>
<li><a class="reference internal" href="#DeltaTopic.nn.util.BaseModelClass"><code class="docutils literal notranslate"><span class="pre">BaseModelClass</span></code></a><ul>
<li><a class="reference internal" href="#DeltaTopic.nn.util.BaseModelClass.device"><code class="docutils literal notranslate"><span class="pre">BaseModelClass.device</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.util.BaseModelClass.history"><code class="docutils literal notranslate"><span class="pre">BaseModelClass.history</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.util.BaseModelClass.is_trained"><code class="docutils literal notranslate"><span class="pre">BaseModelClass.is_trained</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.util.BaseModelClass.load"><code class="docutils literal notranslate"><span class="pre">BaseModelClass.load()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.util.BaseModelClass.save"><code class="docutils literal notranslate"><span class="pre">BaseModelClass.save()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.util.BaseModelClass.test_indices"><code class="docutils literal notranslate"><span class="pre">BaseModelClass.test_indices</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.util.BaseModelClass.to_device"><code class="docutils literal notranslate"><span class="pre">BaseModelClass.to_device()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.util.BaseModelClass.train"><code class="docutils literal notranslate"><span class="pre">BaseModelClass.train()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.util.BaseModelClass.train_indices"><code class="docutils literal notranslate"><span class="pre">BaseModelClass.train_indices</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.util.BaseModelClass.validation_indices"><code class="docutils literal notranslate"><span class="pre">BaseModelClass.validation_indices</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#DeltaTopic.nn.util.DataSplitter"><code class="docutils literal notranslate"><span class="pre">DataSplitter</span></code></a><ul>
<li><a class="reference internal" href="#DeltaTopic.nn.util.DataSplitter.setup"><code class="docutils literal notranslate"><span class="pre">DataSplitter.setup()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.util.DataSplitter.test_dataloader"><code class="docutils literal notranslate"><span class="pre">DataSplitter.test_dataloader()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.util.DataSplitter.train_dataloader"><code class="docutils literal notranslate"><span class="pre">DataSplitter.train_dataloader()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.util.DataSplitter.val_dataloader"><code class="docutils literal notranslate"><span class="pre">DataSplitter.val_dataloader()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#DeltaTopic.nn.util.SimpleLogger"><code class="docutils literal notranslate"><span class="pre">SimpleLogger</span></code></a><ul>
<li><a class="reference internal" href="#DeltaTopic.nn.util.SimpleLogger.experiment"><code class="docutils literal notranslate"><span class="pre">SimpleLogger.experiment()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.util.SimpleLogger.history"><code class="docutils literal notranslate"><span class="pre">SimpleLogger.history</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.util.SimpleLogger.log_hyperparams"><code class="docutils literal notranslate"><span class="pre">SimpleLogger.log_hyperparams()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.util.SimpleLogger.log_metrics"><code class="docutils literal notranslate"><span class="pre">SimpleLogger.log_metrics()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.util.SimpleLogger.name"><code class="docutils literal notranslate"><span class="pre">SimpleLogger.name</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.util.SimpleLogger.version"><code class="docutils literal notranslate"><span class="pre">SimpleLogger.version</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#DeltaTopic.nn.util.TrainRunner"><code class="docutils literal notranslate"><span class="pre">TrainRunner</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.util.Trainer"><code class="docutils literal notranslate"><span class="pre">Trainer</span></code></a><ul>
<li><a class="reference internal" href="#DeltaTopic.nn.util.Trainer.fit"><code class="docutils literal notranslate"><span class="pre">Trainer.fit()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#DeltaTopic.nn.util.parse_use_gpu_arg"><code class="docutils literal notranslate"><span class="pre">parse_use_gpu_arg()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.util.setup_anndata"><code class="docutils literal notranslate"><span class="pre">setup_anndata()</span></code></a></li>
<li><a class="reference internal" href="#DeltaTopic.nn.util.validate_data_split"><code class="docutils literal notranslate"><span class="pre">validate_data_split()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-DeltaTopic.nn">Module contents</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>